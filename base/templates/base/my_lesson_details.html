{% extends "main.html" %}
{% block content %}

<!-- Section Header -->
<h1 style="color: #1E90FF; text-align: center; font-size: 32px; margin-bottom: 10px;">
  <a href="{% url 'my-lessons' my_lesson.user.id %}" 
     style="color: inherit; text-decoration: none;"
     onmouseover="this.style.color='#63b3ed';"
     onmouseout="this.style.color='#1E90FF';">
    {{ my_lesson.user.username }}'s Lessons
  </a>
</h1>

<h2 style="color: white; text-align: center;">
  <a href="{% url 'my-lesson-details' my_lesson.id %}" 
     style="color: #87CEFA; text-decoration: none;"
     onmouseover="this.style.color='#a8d1ff';"
     onmouseout="this.style.color='#87CEFA';">
    {{ my_lesson.lesson.title }}
  </a>
</h2>

<!-- Practice Buttons -->
<div style="text-align: center; margin: 20px 0;">
  <a href="{% url 'start-practice' my_lesson.id 'normal' %}">
    <button class="logout-btn">‚ñ∂ Practice</button>
  </a>
  <a href="{% url 'start-practice' my_lesson.id 'reverse' %}">
    <button class="logout-btn">üîÅ Reverse</button>
  </a>
</div>

<!-- Lesson Metadata -->
<div style="color: white; text-align: center; margin-bottom: 20px;">
  <p><strong>Access:</strong> {{ my_lesson.lesson.access_type.name }}</p>
  <p><strong>Description:</strong> {{ my_lesson.lesson.description }}</p>
  <p><strong>Target Progress:</strong> {{ my_lesson.target_progress }}</p>
</div>

<!-- Search Bar -->
<form method="GET" action="{% url 'my-lesson-details' my_lesson.id %}" style="text-align: center; margin-bottom: 20px;">
  <input type="text" name="q" placeholder="üîç Search word..." 
         style="padding: 10px 15px; border-radius: 6px; border: none; width: 220px;">
  <button type="submit" class="logout-btn">Search</button>
</form>

<!-- Action Buttons -->
<div style="text-align: center; margin-bottom: 30px;">
  <form action="{% url 'delete-my-lesson' my_lesson.id %}" method="get" style="display:inline;">
    <button class="logout-btn" style="background-color: #dc3545;">üóë Delete</button>
  </form>

  <form action="{% url 'copy-lesson' my_lesson.id %}" method="get" style="display:inline;">
    <button class="logout-btn" {% if is_private %}disabled{% endif %}>üìã Copy</button>
  </form>

  <a href="{% url 'export-lesson-json' my_lesson.lesson.id %}">
    <button class="logout-btn">‚¨á Export</button>
  </a>

  <form action="{% url 'edit-lesson' my_lesson.id %}" method="get" style="display:inline;">
    <button class="logout-btn" {% if not is_author %}disabled{% endif %}>‚úèÔ∏è Edit</button>
  </form>
</div>

<!-- Word Table -->
<div class="my-lesson-container" style="overflow-x: auto;">
  <table style="width: 100%; border-collapse: collapse; text-align: center; color: white;">
    <thead style="background-color: #1E90FF;">
      <tr>
        <th style="padding: 12px;">Prompt<br>({{ my_lesson.lesson.prompt_language }})</th>
        <th>Translation<br>({{ my_lesson.lesson.translation_language }})</th>
        <th>Progress</th>
        <th>Details</th>
        <th>Edit</th>
      </tr>
    </thead>
    <tbody>
      {% for my_word in my_words %}
      <tr style="background-color: rgba(255, 255, 255, 0.05);">
        <td style="padding: 10px;">{{ my_word.word.prompt }}</td>
        <td>{{ my_word.word.translation }}</td>
        <td>{{ my_word.current_progress }}</td>
        <td>
          <a href="{% url 'my-word-details' my_word.id %}" 
             style="color: #1E90FF; text-decoration: none;"
             onmouseover="this.style.color='#5ec9ff';"
             onmouseout="this.style.color='#1E90FF';">
             View
          </a>
        </td>
        <td>
          <form action="{% url 'edit-word' my_word.id %}" method="get">
            <button class="logout-btn" {% if not can_edit %}disabled{% endif %}>Edit</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- Add Word Section -->
{% if can_edit %}
<div style="margin-top: 40px; color: white;">
  <h3 style="text-align: center;">‚ûï Add a New Word</h3>
  <form method="POST" action="" style="width: 100%; max-width: 500px; margin: 0 auto;">
    {% csrf_token %}
    {{ word_form.as_p }}
    <input type="submit" value="Add Word" class="logout-btn" />
  </form>
</div>
{% endif %}

{% endblock content %}
